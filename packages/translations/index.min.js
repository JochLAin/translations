"use strict";var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var a,e=1,r=arguments.length;e<r;e++)for(var o in a=arguments[e])Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o]);return t},__assign.apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(t,a,e){if(e||2===arguments.length)for(var r,o=0,n=a.length;o<n;o++)!r&&o in a||(r||(r=Array.prototype.slice.call(a,0,o)),r[o]=a[o]);return t.concat(r||Array.prototype.slice.call(a))};function format(t,a,e){void 0===e&&(e=exports.DEFAULT_LOCALE);for(var r=t,o=Object.keys(a),n=0;n<o.length;n++)r=r.replace(new RegExp("".concat(o[n]),"g"),String(a[o[n]]));return r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.translate=exports.mergeCatalogs=exports.getCatalogValue=exports.formatMessage=exports.createTranslator=exports.Translator=exports.format=exports.DEFAULT_LOCALE=exports.DEFAULT_DOMAIN=void 0,exports.DEFAULT_DOMAIN="messages",exports.DEFAULT_LOCALE="en",exports.format=format;var KEY_SEPARATOR="-",Translator=function(){function t(a,e){void 0===e&&(e={});var r=this;this._fallbackDomain=exports.DEFAULT_DOMAIN,this._fallbackLocale=exports.DEFAULT_LOCALE,this._formatter={format:format},this.addCatalog=function(a,e,o){void 0===a&&(a={}),void 0===e&&(e=r._fallbackDomain),void 0===o&&(o=r._fallbackLocale);var n=t.getMapKey(e,o),s=t.mergeCatalogs(r.getCatalog(e,o),a);return r._catalogs.set(n,s),r},this.getCatalog=function(a,e){void 0===a&&(a=r._fallbackDomain),void 0===e&&(e=r._fallbackLocale);var o=r._catalogs.get(t.getMapKey(a,e));return o||(a.includes("_")?r._catalogs.get(t.getMapKey(a,e.split("_")[0])):void 0)},this.getDomainCatalogs=function(t){return void 0===t&&(t=r._fallbackDomain),r.getLocales().reduce((function(a,e){var o;return __assign(__assign({},a),((o={})[e]=r.getCatalog(t,e),o))}),{})},this.getDomains=function(){return Array.from(r._catalogs.keys()).map((function(a){return t.parseMapKey(a)[0]})).filter((function(t,a,e){return e.indexOf(t)===a}))},this.getLocaleCatalogs=function(t){return void 0===t&&(t=r._fallbackLocale),r.getDomains().reduce((function(a,e){var o;return __assign(__assign({},a),((o={})[e]=r.getCatalog(e,t),o))}),{})},this.getLocales=function(){return Array.from(r._catalogs.keys()).map((function(a){return t.parseMapKey(a)[1]})).filter((function(t,a,e){return e.indexOf(t)===a}))},this.getMessage=function(a,e,o){return void 0===e&&(e=r._fallbackDomain),void 0===o&&(o=r._fallbackLocale),t.getCatalogValue(r.getCatalog(e,o),a)},this.getMessages=function(t,a){return void 0===a&&(a=r._fallbackDomain),r.getLocales().reduce((function(e,o){var n;return __assign(__assign({},e),((n={})[o]=r.getMessage(t,a,o),n))}),{})},this.setFallbackDomain=function(t){return void 0===t&&(t=exports.DEFAULT_DOMAIN),r._fallbackDomain=t,r},this.setFallbackLocale=function(t){return void 0===t&&(t=exports.DEFAULT_LOCALE),r._fallbackLocale=t,r},this.setFormatter=function(t){return r._formatter=t||{format:format},r},this.setTranslations=function(t){return Object.entries(t).forEach((function(t){var a=t[0],e=t[1];Object.entries(e).forEach((function(t){var e=t[0],o=t[1];r.addCatalog(o,e,a)}))})),r},this.translate=function(t,a,e,o){a||(a={}),e||(e=r._fallbackDomain),o||(o=r._fallbackLocale);var n=r.getMessage(t,e,o);return n?(a||(a={}),r._formatter.format(n,a,o)):t},this.withDomain=function(a){return new t(r._catalogs).setFallbackDomain(a).setFallbackLocale(r._fallbackLocale).setFormatter(r._formatter)},this.withFormatter=function(a){return new t(r._catalogs).setFallbackDomain(r._fallbackDomain).setFallbackLocale(r._fallbackLocale).setFormatter(a)},this.withLocale=function(a){return new t(r._catalogs).setFallbackDomain(r._fallbackDomain).setFallbackLocale(a).setFormatter(r._formatter)},this.with=function(a){return new t(r._catalogs).setFallbackDomain(a.domain||r._fallbackDomain).setFallbackLocale(a.locale||r._fallbackLocale).setFormatter(a.formatter||r._formatter)};var o=e.domain,n=void 0===o?exports.DEFAULT_DOMAIN:o,s=e.locale,l=void 0===s?exports.DEFAULT_LOCALE:s,i=e.formatter;this._catalogs=a||new Map,this.setFallbackDomain(n).setFallbackLocale(l).setFormatter(i)}return t.create=function(a,e){void 0===a&&(a={}),void 0===e&&(e={});var r=e.domain,o=void 0===r?exports.DEFAULT_DOMAIN:r,n=e.locale,s=void 0===n?exports.DEFAULT_LOCALE:n,l=e.formatter;return(new t).setFallbackDomain(o).setFallbackLocale(s).setFormatter(l).setTranslations(a)},t.getMapKey=function(t,a){return"".concat(t.toLowerCase()).concat(KEY_SEPARATOR).concat(a.toLowerCase())},t.mergeCatalogs=function(a){for(var e,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];if(a||(a={}),!r.length)return a;var n=r.shift();if("object"==typeof n)for(var s=Object.keys(n),l=0;l<s.length;l++){var i=s[l];"string"==typeof n[i]?Object.assign(a,((e={})[i]=n[i],e)):(a[i]||(a[i]={}),"string"==typeof a[i]&&(a[i]={}),Object.assign(a[i],t.mergeCatalogs(a[i],n[i])))}return t.mergeCatalogs.apply(t,__spreadArray([a],r,!1))},t.parseMapKey=function(t){var a=t.split(KEY_SEPARATOR);return[a[0],a[1]]},t.translate=function(t,a,e,r){void 0===t&&(t={}),void 0===a&&(a={}),void 0===e&&(e=exports.DEFAULT_LOCALE),void 0===r&&(r={format:format});var o=t[e]||t[e.split("_")[0]]||"";return o?(a||(a={}),r.format(o,a,e)):""},Object.defineProperty(t.prototype,"catalogs",{get:function(){return this._catalogs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fallbackDomain",{get:function(){return this._fallbackDomain},set:function(t){this.setFallbackDomain(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"domain",{get:function(){return this.fallbackDomain},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fallbackLocale",{get:function(){return this._fallbackLocale},set:function(t){this.setFallbackLocale(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"locale",{get:function(){return this.fallbackLocale},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"formatter",{get:function(){return this._formatter},set:function(t){this.setFormatter(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"translations",{get:function(){return Array.from(this._catalogs.entries()).reduce((function(a,e){var r=e[0],o=e[1],n=t.parseMapKey(r),s=n[0],l=n[1];return a[l]||(a[l]={}),a[l][s]=o,a}),{})},enumerable:!1,configurable:!0}),t.getCatalogValue=function(t,a){var e=function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];if(!t)return a;if("string"==typeof t)return t;for(var n="";r.length;){var s=r.shift()||"";n?n+=".".concat(s):n=s;var l=t[n];if(l)return e.apply(void 0,__spreadArray([t[n]],r,!1))}return a};return e.apply(void 0,__spreadArray([t],a.split("."),!1))},t}(),proxy=new Proxy(Translator,{apply:function(t,a,e){return Translator.create.apply(Translator,e)},construct:function(t,a){return new(Translator.bind.apply(Translator,__spreadArray([void 0],a,!1)))},set:function(){throw new Error("It's not allowed to add a property to Translator class, please use a composition relation instead.")}});exports.Translator=proxy,exports.default=proxy,exports.createTranslator=Translator.create,exports.formatMessage=format,exports.getCatalogValue=Translator.getCatalogValue,exports.mergeCatalogs=Translator.mergeCatalogs,exports.translate=Translator.translate;